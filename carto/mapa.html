<!DOCTYPE html>
<html> 
    
<head>
<title>Mi primer mapa web con Leaflet</title>
<meta charset="utf-8"/> 


<!-- enlace a CSS de Leaflet v. 1.6.0 en la cabecera -->
<link rel="stylesheet" href="codigo_js/leaflet.css"/>

<!-- enlace a JavaScript de Leaflet v. 1.6.0 (justo tras CSS) -->
<script src="codigo_js/leaflet.js">

</script>

</head>
<body>
<h1>Mapa de prueba</h1>
<p>HOLA HOLA</p>

<!-- bloque dónde aparecerá el mapa -->
<div id="bloque_mapa" 
style="width: 400px; height: 800px;"> 
</div>

<!-- aqui ya se mete el javascript de Leaflet, que incluye el codigo especial para que se vea el mapa-->

<script>
    // definimos el mapa como una varianble y le ajustamos dónde lo queremos ver
    var mi_mapa = L.map('bloque_mapa').setView([40, -2], 5);
    // añadimos mapa de fondo
    L.tileLayer(
    // dirección de las tiles
    'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw',
    // propiedades
    { maxZoom: 10, // zoom máximo 10
    // Líneas de atribución
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' + '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
    id: 'mapbox.streets'
    }).addTo(mi_mapa);
    
// añadimos punto (marcador)
var marker = L.marker([40, -8]); // marcador en esas coordenadas
marker.addTo(mi_mapa); // se añade al mapa


// añadimos círculo
var circulo = L.circle( // variable círculo en esas coordenadas
    [41, -1],  // coordenadas del centro
    {
    color: 'red', // estilo color
    fillColor: '#f03', // color de relleno
    fillOpacity: 0.5, // opacidad del relleno
    radius: 300000 // radio: 300Km
    }
    );
circulo.addTo(mi_mapa); // se añade al mapa (otro modo)

// añadimos polígono
var poligono = L.polygon([ // variable polígono
[35, -5], // coordenadas de los vértices
[46, -3],
[40, 6]
]);
poligono.addTo(mi_mapa) // se añade al mapa

//apartir de aqui se añaden las capas

//cargar TMS1 (TMS=Sistema de imagenes preconfiguradas en el servidor, lo accedes a las teselas)
var stamen_tms = L.tileLayer(
'http://a.tile.stamen.com/terrain/{z}/{x}/{y}.png', 
{ // URL con tiles
    // texto de atribución en html - IMPORTANTE NO OLVIDAR (es como las fuentes)
    attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>,<a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash;Map data: &copy; <a href="http://openstreetmap.org">OpenStreetMap</a>contributors,<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
    maxZoom: 20 // zoom máximo
    });
stamen_tms.addTo(mi_mapa);

//cargar TMS2
// añadir TM de OpenStreetMap render Mapnik 
var OSM_mapnik = L.tileLayer(
    'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', 
{
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors }); OSM_mapnik.addTo(mi_mapa)',
    maxZoom: 19
});
OSM_mapnik.addTo(mi_mapa);

//cargar WMS
var PNOA = L.tileLayer.wms('http://www.idee.es/wms/PNOA/PNOA?', { //URL WMS 
    layers: 'PNOA', // capa del WMS 
    format: 'image/png', // tipo de formato 
    transparent: true, // activa capa alfa/transparente 
    attribution: ' <i>Imagen PNOA</i> &copy; IGN'
    }); 
PNOA.addTo(mi_mapa); // añadir capa al mapa

//Añadiendo controles (activar/ desactivar o cambiar capas)

//1)En basemaps se meten los nombres de las capas que voy a intercambiar

var baseMaps = { // variable con apartado de mapas base 
"OpenStreetMap": OSM_mapnik, // elemento a incluir y descripción 
"Stamen": stamen_tms, }; 
var overlayMaps = { // apartado de capas
"Ortotfoto PNOA": PNOA // elemento a incluir y descripción 
}; 
//2)SOn las capas del proyecto que puedo activar y desactivar
var capas = L.control.layers( // variable con control de capas 
baseMaps, // añadiendo capas base 
overlayMaps, // añadiendo capas 
{collapsed:true}); // control NO desplegado 
capas.addTo(mi_mapa); // añadimos control de capas al mapa 

//añadir escala
var escala = L.control.scale({imperial:false}) //El imperial es para que no salga en millas
 escala.addTo(mi_mapa);

//AÑADIR GEOJSON
//Primero se habre la capa de geojson en una ventana aparte y se añade delante del codigo var provincias = {} y todo el codigo dentro en una ventana aparte

//Se carga javascirpt (objeto geojson transformado)
src="./data/provincias.js" //Mejor ponerlo entre el head y el body (si se pone fuera del codigo de JS acordarse de poner:
//<script src="./data/provincias.js">... + el final del script

//Por ultimo se carga el mapa
// añadir capa GeoJSON
var provincias = L.geoJSON( // crear objeto provincias como capa geojson
  provincias, {             // código a cargar: `provincias`
  color: 'red',             // estilo color
  fillColor: 'blue',        //        color de relleno
  fillOpacity: 0.2,         //        opacidad de relleno
  });

provincias.addTo(mi_map)   //

</script>
<!-- FIN DEL BLOQUE DEL MAPA-->
</body>
</html>